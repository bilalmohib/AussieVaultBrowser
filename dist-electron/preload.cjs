"use strict";const n=require("electron");n.contextBridge.exposeInMainWorld("ipcRenderer",{on(...e){const[o,r]=e;return n.ipcRenderer.on(o,(t,...i)=>r(t,...i))},off(...e){const[o,...r]=e;return n.ipcRenderer.off(o,...r)},send(...e){const[o,...r]=e;return n.ipcRenderer.send(o,...r)},invoke(...e){const[o,...r]=e;return n.ipcRenderer.invoke(o,...r)}});n.contextBridge.exposeInMainWorld("electronAPI",{vpn:{getStatus:()=>n.ipcRenderer.invoke("vpn-get-status"),connect:e=>n.ipcRenderer.invoke("vpn-connect",e),disconnect:()=>n.ipcRenderer.invoke("vpn-disconnect"),onStatusChange:e=>{n.ipcRenderer.on("vpn-status-changed",(o,r)=>e(r))},removeStatusListener:()=>{n.ipcRenderer.removeAllListeners("vpn-status-changed")}},shell:{openPath:e=>n.ipcRenderer.invoke("shell-open-path",e),showItemInFolder:e=>n.ipcRenderer.invoke("shell-show-item-in-folder",e)}});n.contextBridge.exposeInMainWorld("secureBrowser",{vpn:{getStatus:()=>n.ipcRenderer.invoke("vpn-get-status"),connect:e=>n.ipcRenderer.invoke("vpn-connect",e),disconnect:()=>n.ipcRenderer.invoke("vpn-disconnect"),onStatusChange:e=>{n.ipcRenderer.on("vpn-status-changed",(o,r)=>e(r))},removeStatusListener:()=>{n.ipcRenderer.removeAllListeners("vpn-status-changed")}},vault:{getSharePointCredentials:()=>n.ipcRenderer.invoke("vault-get-sharepoint-credentials"),rotateCredentials:()=>n.ipcRenderer.invoke("vault-rotate-credentials"),getVaultStatus:()=>n.ipcRenderer.invoke("vault-get-status")},security:{checkUrlAllowed:(e,o)=>n.ipcRenderer.invoke("security-check-url",e,o),logNavigation:(e,o,r)=>n.ipcRenderer.invoke("security-log-navigation",e,o,r),preventDownload:e=>n.ipcRenderer.invoke("security-prevent-download",e)},sharepoint:{injectCredentials:e=>n.ipcRenderer.invoke("sharepoint-inject-credentials",e),getLibraryConfig:()=>n.ipcRenderer.invoke("sharepoint-get-config"),validateAccess:e=>n.ipcRenderer.invoke("sharepoint-validate-access",e)},system:{getVersion:()=>n.ipcRenderer.invoke("system-get-version"),getEnvironment:()=>n.ipcRenderer.invoke("system-get-environment"),isProduction:()=>!1},extensions:{get1PasswordStatus:()=>n.ipcRenderer.invoke("extension-get-1password-status"),install1Password:()=>n.ipcRenderer.invoke("extension-install-1password")},savePageAsPDF:()=>n.ipcRenderer.invoke("save-page-as-pdf"),shell:{openPath:e=>n.ipcRenderer.invoke("shell-open-path",e),showItemInFolder:e=>n.ipcRenderer.invoke("shell-show-item-in-folder",e)},on:(e,o)=>{["download-started","download-progress","download-completed","download-blocked"].includes(e)&&n.ipcRenderer.on(e,o)},removeListener:(e,o)=>{["download-started","download-progress","download-completed","download-blocked"].includes(e)&&n.ipcRenderer.removeListener(e,o)},window:{createNew:()=>n.ipcRenderer.invoke("window-create-new"),getCount:()=>n.ipcRenderer.invoke("window-get-count"),close:e=>n.ipcRenderer.invoke("window-close",e)},contextMenu:{show:e=>n.ipcRenderer.invoke("context-menu-show",e),onAction:e=>{n.ipcRenderer.on("context-menu-action",(o,r)=>e(r))},removeActionListener:()=>{n.ipcRenderer.removeAllListeners("context-menu-action")}}});delete window.module;delete window.exports;delete window.require;try{Object.freeze(console)}catch{}console.log("🔒 Secure Browser Preload: Context isolation enabled");console.log("🌐 VPN-routed traffic: Ready for Australian endpoint");console.log("🔑 Vault integration: SharePoint credentials secure");
